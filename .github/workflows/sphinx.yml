# Workflow derived from https://github.com/r-lib/actions/tree/v2/examples
name: Build and Deploy
on: [push]
permissions:
  contents: write
jobs:
  build-and-deploy:
    concurrency: ci-${{ github.ref }} # Recommended if you intend to make multiple deployments in quick succession.
    runs-on: ubuntu-latest
    steps:
      - name: Checkout üõéÔ∏è
        uses: actions/checkout@v3

      # - name: Install and Build üîß # This example project is built using npm and outputs the result to the 'build' folder. Replace with the commands required to build your project, or remove this step entirely if your site is pre-built.
      #   run: |
      #     sphinx-build docs _build
      # - name: Build documentation
      #   uses: ammaraskar/sphinx-action@master
      #   with:
      #     docs-folder: "docs/"
      - name: Install dependencies
        run: |
          sudo apt-get install pandoc
          python -m pip install --upgrade pip
          python -m pip install sphinx nbsphinx myst-parser sphinx_rtd_theme
          if [ -f docs/requirements.txt ]; then pip install -r docs/requirements.txt; fi

      - name: Build documentation
        run: |
          sphinx-build docs _build

  # Single deploy job since we're just deploying
  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Setup Pages
        uses: actions/configure-pages@v2
      - name: Upload artifact
        uses: actions/upload-pages-artifact@v1
        with:
          # folder to upload.
          path: '_build'
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v1