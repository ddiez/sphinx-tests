# Workflow derived from https://github.com/r-lib/actions/tree/v2/examples
name: Build and Deploy
on: [push]
permissions:
  contents: write
jobs:
  build-and-deploy:
    concurrency: ci-${{ github.ref }} # Recommended if you intend to make multiple deployments in quick succession.
    runs-on: ubuntu-latest
    steps:
      - name: Checkout ğŸ›ï¸
        uses: actions/checkout@v3

      # - name: Install and Build ğŸ”§ # This example project is built using npm and outputs the result to the 'build' folder. Replace with the commands required to build your project, or remove this step entirely if your site is pre-built.
      #   run: |
      #     sphinx-build docs _build
      # - name: Build documentation
      #   uses: ammaraskar/sphinx-action@master
      #   with:
      #     docs-folder: "docs/"
      - name: Install dependencies
        run: |
          sudo apt-get install pandoc
          python -m pip install --upgrade pip
          python -m pip install sphinx nbsphinx myst-parser sphinx_rtd_theme
          if [ -f docs/requirements.txt ]; then pip install -r docs/requirements.txt; fi

      - name: Build documentation
        run: |
          sphinx-build docs _build
          touch _build/.nojekyll

      - name: Deploy ğŸš€
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          clean: false
          branch: gh-pages
          folder: _build # The folder the action should deploy.